# Scripted Giggles

**Author: Suraj S**  
**Points: 50**  
**Difficulty: Easy**  

**Description:**  

An auditor at WindShine Pvt Ltd suspects illegal activities and discovers cryptic codes in financial reports. Running the investigation script reveals hidden data that exposes corruption within the company.

#### [flag.py](flag.py)

## Solution

The challenge involves understanding how the provided code works to encrypt and decrypt the flag using XOR encryption.

Steps to Decrypt the Flag

1. Understand the XOR Encryption Method:
The function str_xor(secret, key) takes a string (secret) and a key to perform an XOR operation on each character. The key is reused cyclically if it is shorter than the secret.

2. Flag Encoding:
The flag is represented by a list of hexadecimal values in flag_enc_values. When these values are converted to characters, they form the encrypted flag.

3. Encryption Process:
The encrypted flag is generated by passing the original flag and the key "windshine" through the str_xor function.

4. Decryption:
To retrieve the original flag, we can simply run the XOR function again on the encrypted flag using the same key. This is because XORing twice with the same key returns the original value.

The code already implements this logic. When you run the main() function, it will print the encrypted flag and then decrypt it to obtain the original flag.

To get the decrypted flag, we need simply call the print(decrypted_flag) line at the end of the main() function. When executed, the final output will reveal the flag.

```python
def main():
    flag_enc_values = [
        0x63, 0x79, 0x62, 0x65, 0x72, 0x61, 0x72, 0x63, 0x7b,
        0x53, 0x63, 0x72, 0x31, 0x70, 0x74, 0x5f, 0x72, 0x41,
        0x6e, 0x5f, 0x53, 0x75, 0x63, 0x63, 0x65, 0x35, 0x35,
        0x66, 0x75, 0x6c, 0x6c, 0x79, 0x7d
    ]
    
    flag = ''.join(chr(value) for value in flag_enc_values)
    
    key = "windshine"
    
    encrypted_flag = str_xor(flag, key)
    
    print(encrypted_flag)
    
    decrypted_flag = str_xor(encrypted_flag, key)
    print(decrypted_flag)
    

if __name__ == "__main__":
    main()

```

### **Flag: `cyberarc{Scr1pt_rAn_Succe55fully}`**